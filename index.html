<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Code Lab - Ultimate Pro</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Fira+Code:wght@300;400;500&display=swap">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/css/css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/edit/closetag.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/search/search.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/search/searchcursor.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/dialog/dialog.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/dialog/dialog.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/show-hint.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/show-hint.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/html-hint.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/css-hint.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/javascript-hint.min.js"></script>
    <style>
        /* Global reset and dark theme */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #000;
            color: #fff;
            font-family: 'Orbitron', sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* ---------- Root Neon Palette ---------- */
        :root{
          --fire:#ff4757;
          --ice:#00d2d3;
          --void:#5f27cd;
          --earth:#2ed573;
          --dark:#01020f;
          --glow1:#00ffff80;
          --glow2:#ff00ff80;
        }

        #software-lab{
          background:radial-gradient(ellipse at center, #0a0e27 0%, var(--dark) 100%);
          padding: 20px 10px;
          color:#fff;
          font-family:'Orbitron','Segoe UI',sans-serif;
          min-height: 100vh;
        }

        /* ---------- Glitch Neon Title ---------- */
        .neural-title{
          position:relative;
          font-size:clamp(1.5rem, 8vw, 3.5rem);
          font-weight:900;
          text-align:center;
          letter-spacing:2px;
          text-shadow:
            0 0 5px var(--ice),
            0 0 10px var(--ice),
            0 0 20px var(--ice),
            0 0 40px var(--glow1),
            0 0 80px var(--glow1);
          margin-bottom: 10px;
        }
        .neural-title::before,
        .neural-title::after{
          content:attr(data-text);
          position:absolute;
          top:0;left:0;
          width:100%;height:100%;
        }
        .neural-title::before{
          left:2px;
          text-shadow:-2px 0 var(--glow1);
          clip:rect(44px, 9999px, 56px, 0);
          animation:glitch 1.2s infinite;
        }
        .neural-title::after{
          left:-2px;
          text-shadow:-2px 0 var(--glow2);
          clip:rect(84px, 9999px, 96px, 0);
          animation:glitch 1.5s infinite reverse;
        }
        @keyframes glitch{
          0%{transform:translate(0)}
          20%{transform:translate(-3px, 3px)}
          40%{transform:translate(-3px, -3px)}
          60%{transform:translate(3px, 3px)}
          80%{transform:translate(3px, -3px)}
          100%{transform:translate(0)}
        }
        .neural-sub{
          text-align:center;
          font-size:clamp(0.9rem, 3vw, 1.2rem);
          color:var(--ice);
          text-shadow:0 0 8px var(--ice);
          margin-bottom:1.5rem;
        }

        /* ---------- Layout ---------- */
        .lab-grid{
          display:grid;
          grid-template-columns:1fr;
          gap:20px;
          max-width:1200px;
          margin:auto;
        }
        @media(min-width: 900px){
          .lab-grid{
            grid-template-columns:1fr 1fr;
            gap:30px;
          }
        }

        /* ---------- Editor Panel ---------- */
        .editor-panel{
          background:rgba(13,17,23,.7);
          border:1px solid var(--ice);
          border-radius:15px;
          display:flex;
          flex-direction:column;
          overflow:hidden;
          backdrop-filter:blur(6px);
          box-shadow:0 0 20px var(--ice);
          min-height: 500px;
        }
        .synapse-tabs{
          display:flex;
          border-bottom:1px solid var(--ice);
        }
        .syn-tab{
          flex:1;
          background:transparent;
          border:none;
          color:var(--ice);
          padding:.7rem;
          font-family:'Orbitron',sans-serif;
          font-weight:500;
          cursor:pointer;
          transition:.3s;
          position:relative;
          font-size: clamp(0.8rem, 2.5vw, 1rem);
        }
        .syn-tab.active{
          color:#fff;
          text-shadow:0 0 10px var(--ice);
        }
        .syn-tab::after{
          content:'';
          position:absolute;
          bottom:0;left:50%;
          width:0;height:2px;
          background:var(--ice);
          transition:.3s;
          transform:translateX(-50%);
        }
        .syn-tab.active::after{width:80%;}

        .code-area{flex:1;position:relative;}
        .neural-editor{
          width:100%;height:450px;
          background:#010409;
          color:#e6edf3;
          border:none;
          padding:1rem;
          font-family:'Fira Code',monospace;
          font-size:.95rem;
          line-height:1.6;
          resize:none;
          caret-color:var(--fire);
        }
        .neural-editor:focus{outline:none;}
        .hidden{display:none;}

        /* ---------- Neon Buttons ---------- */
        .neural-controls{
          display:flex;
          gap:10px;
          padding:.8rem;
          background:rgba(0,0,0,.3);
          flex-wrap: wrap;
        }
        .neural-btn{
          flex: 1 1 45%;
          background:transparent;
          border:1px solid;
          border-radius:30px;
          padding:.6rem;
          font-family:'Orbitron',sans-serif;
          font-weight:600;
          cursor:pointer;
          transition:.3s;
          position:relative;
          overflow:hidden;
          font-size: clamp(0.8rem, 2.5vw, 1rem);
          min-width: 120px;
        }
        @media (min-width: 768px) {
          .neural-btn {
            flex: 1;
          }
        }
        .neural-btn.fire{
          color:var(--fire);
          border-color:var(--fire);
          box-shadow:0 0 8px var(--fire);
        }
        .neural-btn.fire:hover{
          background:var(--fire);
          color:#000;
          box-shadow:0 0 25px var(--fire);
        }
        .neural-btn.ice{
          color:var(--ice);
          border-color:var(--ice);
          box-shadow:0 0 8px var(--ice);
        }
        .neural-btn.ice:hover{
          background:var(--ice);
          color:#000;
          box-shadow:0 0 25px var(--ice);
        }
        .neural-btn.void{
          color:var(--void);
          border-color:var(--void);
          box-shadow:0 0 8px var(--void);
        }
        .neural-btn.void:hover{
          background:var(--void);
          color:#fff;
          box-shadow:0 0 25px var(--void);
        }
        .neural-btn.earth{
          color:var(--earth);
          border-color:var(--earth);
          box-shadow:0 0 8px var(--earth);
        }
        .neural-btn.earth:hover{
          background:var(--earth);
          color:#000;
          box-shadow:0 0 25px var(--earth);
        }

        /* ---------- Preview Panel ---------- */
        .preview-panel{
          position:relative;
          background:#000;
          border:1px solid var(--fire);
          border-radius:15px;
          overflow:hidden;
          box-shadow:0 0 25px var(--fire);
          min-height: 500px;
        }
        #neuralCanvas{
          position:absolute;
          top:0;left:0;
          width:100%;height:100%;
          pointer-events:none;
        }
        #liveFrame{
          width:100%;height:450px;
          border:none;
          background:#000;
          transition:opacity .4s;
        }

        /* Enhanced Features Styles */
        .enhanced-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 8px;
        }

        .feature-btn {
            background: rgba(13,17,23,.7);
            border: 1px solid var(--void);
            color: var(--void);
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(0.7rem, 2.5vw, 0.9rem);
            flex: 1 1 22%;
            min-width: 80px;
            text-align: center;
        }

        .feature-btn:hover {
            background: var(--void);
            color: #fff;
            box-shadow: 0 0 15px var(--void);
        }

        .template-selector, .theme-selector {
            background: rgba(13,17,23,.9);
            border: 1px solid var(--earth);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            display: none;
        }

        .template-item, .theme-item {
            padding: 8px;
            margin: 5px 0;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .template-item:hover, .theme-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .console-panel {
            background: #1a1a1a;
            border: 1px solid var(--fire);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
            display: none;
        }

        .console-log {
            color: #00ff00;
            margin-bottom: 5px;
        }

        .console-error {
            color: #ff4757;
            margin-bottom: 5px;
        }

        .project-manager {
            background: rgba(13,17,23,.9);
            border: 1px solid var(--ice);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            display: none;
        }

        .project-item {
            padding: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
        }

        .project-item:hover {
            background: rgba(255,255,255,0.05);
        }

        /* CodeMirror Customization */
        .CodeMirror {
            height: 450px !important;
            background: #010409 !important;
            color: #e6edf3 !important;
            font-family: 'Fira Code', monospace !important;
            font-size: 0.95rem !important;
            line-height: 1.6 !important;
        }

        .CodeMirror-gutters {
            background: #010409 !important;
            border-right: 1px solid #333 !important;
        }

        .CodeMirror-linenumber {
            color: #666 !important;
        }

        /* Mobile-specific improvements */
        .mobile-warning {
            display: none;
            background: rgba(255, 71, 87, 0.2);
            border: 1px solid var(--fire);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 15px;
            text-align: center;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .mobile-warning {
                display: block;
            }
            
            .neural-controls {
                justify-content: center;
            }
            
            .enhanced-controls {
                justify-content: center;
            }
            
            .feature-btn {
                flex: 1 1 45%;
            }
            
            .template-selector, .theme-selector, .project-manager, .console-panel {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 90%;
                max-width: 400px;
                max-height: 80vh;
                overflow-y: auto;
                z-index: 1000;
            }
            
            .overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                z-index: 999;
            }
        }

        /* AI Assistant Styles */
        .ai-panel {
            background: rgba(13,17,23,.9);
            border: 1px solid var(--void);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            display: none;
        }

        .tutorial-item {
            padding: 10px;
            margin: 5px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tutorial-item:hover {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
        }

        /* New Features Styles */
        .component-library {
            background: rgba(13,17,23,.9);
            border: 1px solid var(--earth);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            display: none;
            max-height: 400px;
            overflow-y: auto;
        }

        .component-category {
            margin-bottom: 15px;
        }

        .component-item {
            padding: 8px;
            margin: 5px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .component-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .color-picker {
            background: rgba(13,17,23,.9);
            border: 1px solid var(--ice);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            display: none;
        }

        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            margin: 5px;
            cursor: pointer;
            display: inline-block;
            border: 2px solid transparent;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .device-emulator {
            background: rgba(13,17,23,.9);
            border: 1px solid var(--fire);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            display: none;
        }

        .device-option {
            padding: 10px;
            margin: 5px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
        }

        .challenge-mode {
            background: rgba(13,17,23,.9);
            border: 1px solid var(--void);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            display: none;
        }

        .challenge-item {
            padding: 10px;
            margin: 5px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 5px;
            cursor: pointer;
        }

        .reward-system {
            background: rgba(13,17,23,.9);
            border: 1px solid var(--earth);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            display: none;
        }

        .achievement {
            padding: 10px;
            margin: 5px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .achievement.locked {
            opacity: 0.5;
        }

        /* Progress bars */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--ice), var(--earth));
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* New Feature Panels */
        .feature-panel {
            background: rgba(13,17,23,.9);
            border: 1px solid var(--ice);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            display: none;
            max-height: 500px;
            overflow-y: auto;
        }

        .feature-item {
            padding: 10px;
            margin: 5px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .feature-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .feature-section {
            margin-bottom: 15px;
        }

        .feature-section h4 {
            color: var(--ice);
            margin-bottom: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 5px;
        }

        /* Dark/Light Mode Toggle */
        .mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(13,17,23,.7);
            border: 1px solid var(--ice);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s;
        }

        .mode-toggle:hover {
            box-shadow: 0 0 15px var(--ice);
        }

        /* Split View */
        .split-view-container {
            display: flex;
            height: 100%;
            width: 100%;
        }

        .split-editor, .split-preview {
            flex: 1;
            height: 100%;
        }

        /* Leaderboard */
        .leaderboard {
            background: rgba(13,17,23,.9);
            border: 1px solid var(--earth);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            display: none;
        }

        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .leaderboard-item:nth-child(1) {
            background: rgba(255,215,0,0.1);
        }

        .leaderboard-item:nth-child(2) {
            background: rgba(192,192,192,0.1);
        }

        .leaderboard-item:nth-child(3) {
            background: rgba(205,127,50,0.1);
        }

        /* Audio Controls */
        .audio-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(13,17,23,.7);
            border: 1px solid var(--void);
            border-radius: 10px;
            padding: 10px;
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .audio-btn {
            background: transparent;
            border: 1px solid var(--void);
            color: var(--void);
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .audio-btn:hover {
            background: var(--void);
            color: white;
        }
    </style>
</head>
<body>
    <!-- ================== Neural Code Lab - Ultimate Pro ================== -->
    <section id="software-lab" class="sci-fi-section neon-lab">
      <h2 class="neural-title" data-text="Neural Code Lab Pro">Neural Code Lab Pro</h2>
      <p class="neural-sub">Advanced coding environment with AI-powered features</p>
      
      <!-- Dark/Light Mode Toggle -->
      <div class="mode-toggle" id="modeToggle">
          <span id="modeIcon">üåô</span>
      </div>

      <!-- Audio Controls -->
      <div class="audio-controls" id="audioControls">
          <button class="audio-btn" id="playAudio">üîä Play</button>
          <button class="audio-btn" id="stopAudio">üîá Stop</button>
      </div>

      <!-- Mobile Warning -->
      <div class="mobile-warning">
        <strong>Mobile Mode:</strong> Some features may work differently on mobile devices.
      </div>

      <!-- Enhanced Controls -->
      <div class="enhanced-controls">
          <button class="feature-btn" id="templatesBtn">Templates</button>
          <button class="feature-btn" id="projectsBtn">Projects</button>
          <button class="feature-btn" id="themeBtn">Themes</button>
          <button class="feature-btn" id="consoleBtn">Console</button>
          <button class="feature-btn" id="componentsBtn">üß© Components</button>
          <button class="feature-btn" id="colorBtn">üé® Colors</button>
          <button class="feature-btn" id="analyzeBtn">üîç Analyze</button>
          <button class="feature-btn" id="exportBtn">üì§ Export</button>
          <button class="feature-btn" id="aiBtn">ü§ñ AI Assist</button>
          <button class="feature-btn" id="snippetsBtn">üíæ Snippets</button>
          <button class="feature-btn" id="tutorialsBtn">üìö Learn</button>
          <button class="feature-btn" id="settingsBtn">‚öôÔ∏è Settings</button>
          <button class="feature-btn" id="deviceBtn">üì± Devices</button>
          <button class="feature-btn" id="challengeBtn">‚öîÔ∏è Challenges</button>
          <button class="feature-btn" id="rewardsBtn">üèÜ Rewards</button>
          <button class="feature-btn" id="versionBtn">üîÑ Versions</button>
          <button class="feature-btn" id="optimizeBtn">üöÄ Optimize</button>
          <button class="feature-btn" id="docsBtn">üìñ Docs</button>
          <button class="feature-btn" id="compatibilityBtn">üîß Compatible</button>
          <button class="feature-btn" id="shareBtn">üîó Share</button>
          <button class="feature-btn" id="newFeaturesBtn">‚ú® 40+ Features</button>
      </div>

      <!-- Overlay for mobile modals -->
      <div class="overlay" id="overlay"></div>

      <!-- All Feature Panels -->
      <div class="template-selector" id="templateSelector">
          <h3 style="color: var(--earth); margin-bottom: 10px;">Code Templates</h3>
          <div class="template-item" data-template="starter">Starter Template</div>
          <div class="template-item" data-template="landing">Landing Page</div>
          <div class="template-item" data-template="calculator">Calculator</div>
          <div class="template-item" data-template="portfolio">Portfolio</div>
          <div class="template-item" data-template="game">Simple Game</div>
          <button class="feature-btn" style="margin-top: 10px; width: 100%;" onclick="hideAllPanels()">Close</button>
      </div>

      <!-- Component Library -->
      <div class="component-library" id="componentsPanel">
          <h3 style="color: var(--earth); margin-bottom: 10px;">Component Library</h3>
          
          <div class="component-category">
              <h4 style="color: var(--ice); margin-bottom: 5px;">Navigation</h4>
              <div class="component-item" data-component="navbar">Navigation Bar</div>
              <div class="component-item" data-component="sidebar">Sidebar Menu</div>
              <div class="component-item" data-component="breadcrumb">Breadcrumbs</div>
          </div>
          
          <div class="component-category">
              <h4 style="color: var(--ice); margin-bottom: 5px;">Forms</h4>
              <div class="component-item" data-component="contact-form">Contact Form</div>
              <div class="component-item" data-component="login-form">Login Form</div>
              <div class="component-item" data-component="search-form">Search Form</div>
          </div>
          
          <div class="component-category">
              <h4 style="color: var(--ice); margin-bottom: 5px;">UI Elements</h4>
              <div class="component-item" data-component="cards">Card Grid</div>
              <div class="component-item" data-component="modal">Modal Dialog</div>
              <div class="component-item" data-component="accordion">Accordion</div>
          </div>
          
          <button class="feature-btn" style="margin-top: 10px; width: 100%;" onclick="hideAllPanels()">Close</button>
      </div>

      <!-- Color Generator -->
      <div class="color-picker" id="colorPanel">
          <h3 style="color: var(--ice); margin-bottom: 10px;">Smart Color Generator</h3>
          
          <div style="margin-bottom: 15px;">
              <input type="color" id="baseColor" value="#ff4757" style="width: 100%; height: 50px;">
              <div style="text-align: center; margin-top: 5px;">Base Color</div>
          </div>
          
          <div id="colorPalette" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; margin: 15px 0;">
              <!-- Colors will be generated here -->
          </div>
          
          <button class="feature-btn" style="width: 100%;" onclick="generateColorPalette()">Generate Palette</button>
          <button class="feature-btn" style="margin-top: 10px; width: 100%;" onclick="hideAllPanels()">Close</button>
      </div>

      <!-- Device Emulator -->
      <div class="device-emulator" id="devicePanel">
          <h3 style="color: var(--fire); margin-bottom: 10px;">Device Emulator</h3>
          
          <div class="device-option" data-width="375" data-height="667">üì± iPhone SE</div>
          <div class="device-option" data-width="414" data-height="896">üì± iPhone 11</div>
          <div class="device-option" data-width="768" data-height="1024">üì± iPad</div>
          <div class="device-option" data-width="1024" data-height="768">üíª Desktop</div>
          <div class="device-option" data-width="1920" data-height="1080">üñ•Ô∏è HD Desktop</div>
          
          <button class="feature-btn" style="margin-top: 10px; width: 100%;" onclick="hideAllPanels()">Close</button>
      </div>

      <!-- Challenge Mode -->
      <div class="challenge-mode" id="challengePanel">
          <h3 style="color: var(--void); margin-bottom: 10px;">Coding Challenges</h3>
          
          <div class="challenge-item" data-challenge="counter">üî¢ Build a Counter</div>
          <div class="challenge-item" data-challenge="timer">‚è±Ô∏è Create a Timer</div>
          <div class="challenge-item" data-challenge="quiz">‚ùì Make a Quiz App</div>
          <div class="challenge-item" data-challenge="weather">üå§Ô∏è Weather Widget</div>
          <div class="challenge-item" data-challenge="calculator">üßÆ Advanced Calculator</div>
          
          <div class="progress-bar">
              <div class="progress-fill" style="width: 40%;"></div>
          </div>
          <div style="text-align: center; font-size: 0.9rem;">Progress: 2/5 Challenges Completed</div>
          
          <button class="feature-btn" style="margin-top: 10px; width: 100%;" onclick="hideAllPanels()">Close</button>
      </div>

      <!-- Reward System -->
      <div class="reward-system" id="rewardsPanel">
          <h3 style="color: var(--earth); margin-bottom: 10px;">Achievements & Rewards</h3>
          
          <div class="achievement">
              <span>üèÜ</span>
              <div>
                  <strong>First Project</strong>
                  <div style="font-size: 0.8rem;">Create your first project</div>
              </div>
          </div>
          
          <div class="achievement locked">
              <span>üîí</span>
              <div>
                  <strong>Code Master</strong>
                  <div style="font-size: 0.8rem;">Write 1000 lines of code</div>
              </div>
          </div>
          
          <div class="achievement">
              <span>üé®</span>
              <div>
                  <strong>Design Pro</strong>
                  <div style="font-size: 0.8rem;">Use all color features</div>
              </div>
          </div>
          
          <button class="feature-btn" style="margin-top: 10px; width: 100%;" onclick="hideAllPanels()">Close</button>
      </div>

      <!-- 40+ Features Panel -->
      <div class="feature-panel" id="newFeaturesPanel">
          <h3 style="color: var(--ice); margin-bottom: 10px;">‚ú® 40+ Advanced Features</h3>
          
          <div class="feature-section">
              <h4>üé® UI & UX</h4>
              <div class="feature-item" data-feature="darkMode">Auto Dark/Light Mode</div>
              <div class="feature-item" data-feature="iconLibrary">Icon & Symbol Library</div>
              <div class="feature-item" data-feature="codeOrganizer">Code Organizer</div>
              <div class="feature-item" data-feature="dragDrop">Drag & Drop Editor</div>
              <div class="feature-item" data-feature="splitView">Split View Mode</div>
          </div>
          
          <div class="feature-section">
              <h4>‚ö° Performance</h4>
              <div class="feature-item" data-feature="speedAnalyzer">Load Speed Analyzer</div>
              <div class="feature-item" data-feature="imageCompressor">Auto Image Compressor</div>
              <div class="feature-item" data-feature="deadCode">Dead Code Remover</div>
              <div class="feature-item" data-feature="memoryAnalyzer">Memory Usage Analyzer</div>
              <div class="feature-item" data-feature="cacheTool">Cache Management Tool</div>
          </div>
          
          <div class="feature-section">
              <h4>ü§ñ AI Features</h4>
              <div class="feature-item" data-feature="aiDesign">AI Design Assistant</div>
              <div class="feature-item" data-feature="logoGenerator">Smart Logo Generator</div>
              <div class="feature-item" data-feature="textToUI">Text to UI Converter</div>
              <div class="feature-item" data-feature="bugFixer">Bug Fixing Assistant</div>
              <div class="feature-item" data-feature="codeImprover">Code Improvement Suggester</div>
          </div>
          
          <div class="feature-section">
              <h4>üõ†Ô∏è Developer Tools</h4>
              <div class="feature-item" data-feature="cssInspector">CSS Property Inspector</div>
              <div class="feature-item" data-feature="networkAnalyzer">Network Analyzer</div>
              <div class="feature-item" data-feature="functionTester">Function Tester</div>
              <div class="feature-item" data-feature="codeLinter">Code Linter</div>
              <div class="feature-item" data-feature="unitConverter">Unit Converter</div>
          </div>
          
          <div class="feature-section">
              <h4>üéØ Learning & Development</h4>
              <div class="feature-item" data-feature="algorithmLab">Algorithm Laboratory</div>
              <div class="feature-item" data-feature="dbSimulator">Database Simulator</div>
              <div class="feature-item" data-feature="designPatterns">Design Patterns Trainer</div>
              <div class="feature-item" data-feature="securityLab">Security Laboratory</div>
              <div class="feature-item" data-feature="codeStructure">Code Structure Analyzer</div>
          </div>
          
          <div class="feature-section">
              <h4>üîÑ Integrations</h4>
              <div class="feature-item" data-feature="apiIntegration">External API Integration</div>
              <div class="feature-item" data-feature="packageManager">Package Manager</div>
              <div class="feature-item" data-feature="tokenGenerator">Token Generator</div>
              <div class="feature-item" data-feature="thirdParty">Third-Party Services Connector</div>
              <div class="feature-item" data-feature="cloudSync">Cloud Synchronization</div>
          </div>
          
          <div class="feature-section">
              <h4>üìä Data & Reports</h4>
              <div class="feature-item" data-feature="usageDashboard">Usage Analytics Dashboard</div>
              <div class="feature-item" data-feature="monthlyReports">Monthly Report Generator</div>
              <div class="feature-item" data-feature="codeTrends">Code Trends Analyzer</div>
              <div class="feature-item" data-feature="changeTracker">Change Tracker</div>
              <div class="feature-item" data-feature="statistics">Statistics System</div>
          </div>
          
          <div class="feature-section">
              <h4>üéÆ Interaction & Fun</h4>
              <div class="feature-item" data-feature="pointsSystem">Points & Challenges System</div>
              <div class="feature-item" data-feature="leaderboard">Leaderboard</div>
              <div class="feature-item" data-feature="interactiveAchievements">Interactive Achievements</div>
              <div class="feature-item" data-feature="codingGames">Educational Coding Games</div>
              <div class="feature-item" data-feature="codingCompetitions">Coding Competitions</div>
          </div>
          
          <div class="feature-section">
              <h4>üéµ Multi-Sensory</h4>
              <div class="feature-item" data-feature="voiceComments">Voice Comments for Code</div>
              <div class="feature-item" data-feature="soundEffects">Interactive Sound Effects</div>
              <div class="feature-item" data-feature="musicGenerator">Code-based Music Generator</div>
              <div class="feature-item" data-feature="gestureControl">Gesture Control</div>
              <div class="feature-item" data-feature="voiceInteraction">Voice Interaction</div>
          </div>
          
          <div class="feature-section">
              <h4>üåê Advanced Features</h4>
              <div class="feature-item" data-feature="languageTranslator">Built-in Language Translator</div>
              <div class="feature-item" data-feature="interactiveDocs">Interactive Documentation Generator</div>
              <div class="feature-item" data-feature="codeQuality">Code Quality Analyzer</div>
              <div class="feature-item" data-feature="cvGenerator">Programming CV Generator</div>
              <div class="feature-item" data-feature="3dModeling">3D Modeling</div>
          </div>
          
          <button class="feature-btn" style="margin-top: 10px; width: 100%;" onclick="hideAllPanels()">Close</button>
      </div>

      <!-- Leaderboard Panel -->
      <div class="leaderboard" id="leaderboardPanel">
          <h3 style="color: var(--earth); margin-bottom: 10px;">üèÜ Coding Leaderboard</h3>
          
          <div class="leaderboard-item">
              <span>üëë CodeMaster42</span>
              <span>2,450 pts</span>
          </div>
          <div class="leaderboard-item">
              <span>ü•à DevNinja</span>
              <span>1,890 pts</span>
          </div>
          <div class="leaderboard-item">
              <span>ü•â PixelWizard</span>
              <span>1,560 pts</span>
          </div>
          <div class="leaderboard-item">
              <span>4. ByteBender</span>
              <span>1,230 pts</span>
          </div>
          <div class="leaderboard-item">
              <span>5. SyntaxSorcerer</span>
              <span>980 pts</span>
          </div>
          
          <button class="feature-btn" style="margin-top: 10px; width: 100%;" onclick="hideAllPanels()">Close</button>
      </div>

      <div class="lab-grid">
        <!-- ===== Code Editor ===== -->
        <div class="editor-panel neon-box">
          <div class="synapse-tabs">
            <button class="syn-tab active" data-lang="html">HTML</button>
            <button class="syn-tab" data-lang="css">CSS</button>
            <button class="syn-tab" data-lang="js">JS</button>
          </div>

          <div class="code-area">
            <textarea id="htmlCode" class="neural-editor hidden" placeholder="<!-- Start here -->"></textarea>
            <textarea id="cssCode" class="neural-editor hidden" placeholder="/* Styles */"></textarea>
            <textarea id="jsCode" class="neural-editor hidden" placeholder="// Logic"></textarea>
          </div>

          <div class="neural-controls">
            <button class="neural-btn fire" id="runBtn">Launch Code</button>
            <button class="neural-btn ice" id="saveBtn">Save to Memory</button>
            <button class="neural-btn void" id="clearBtn">Erase Synapses</button>
            <button class="neural-btn earth" id="zipBtn">Download ZIP</button>
          </div>
        </div>

        <!-- ===== Live Preview ===== -->
        <div class="preview-panel neon-box">
          <canvas id="neuralCanvas"></canvas>
          <iframe id="liveFrame" title="live preview"></iframe>
        </div>
      </div>
    </section>

    <!-- ================== Neural Canvas Script ================== -->
    <script>
        const canvas = document.getElementById('neuralCanvas');
        const ctx = canvas.getContext('2d');
        
        function resizeCanvas(){
          canvas.width = canvas.offsetWidth;
          canvas.height = canvas.offsetHeight;
        }
        
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        const nodes = [];
        const conns = [];
        const nodeCount = 50;

        for(let i=0;i<nodeCount;i++){
          nodes.push({
            x:Math.random()*canvas.width,
            y:Math.random()*canvas.height,
            vx:(Math.random()-.5)*.3,
            vy:(Math.random()-.5)*.3,
            r:Math.random()*1.5+1,
            pulse:Math.random()*Math.PI*2
          });
        }
        
        for(let i=0;i<nodes.length;i++){
          for(let j=i+1;j<nodes.length;j++){
            if(Math.hypot(nodes[i].x-nodes[j].x, nodes[i].y-nodes[j].y) < 130){
              conns.push({a:nodes[i], b:nodes[j]});
            }
          }
        }

        function drawNeural(){
          ctx.clearRect(0,0,canvas.width,canvas.height);
          
          conns.forEach(c=>{
            ctx.beginPath();
            ctx.moveTo(c.a.x, c.a.y);
            ctx.lineTo(c.b.x, c.b.y);
            ctx.strokeStyle = 'rgba(0,255,255,0.18)';
            ctx.lineWidth = 1;
            ctx.stroke();
          });
          
          nodes.forEach(n=>{
            n.x += n.vx;
            n.y += n.vy;
            n.pulse += 0.02;
            if(n.x < 0 || n.x > canvas.width) n.vx *= -1;
            if(n.y < 0 || n.y > canvas.height) n.vy *= -1;
            ctx.beginPath();
            ctx.arc(n.x, n.y, n.r + Math.sin(n.pulse)*.5, 0, Math.PI*2);
            ctx.fillStyle = 'rgba(0,255,255,0.85)';
            ctx.shadowBlur = 12;
            ctx.shadowColor = '#00ffff';
            ctx.fill();
            ctx.shadowBlur = 0;
          });
          
          requestAnimationFrame(drawNeural);
        }
        drawNeural();
    </script>

    <!-- ================== Enhanced Editor Logic ================== -->
    <script>
        // Core Elements
        const panels = {
            template: document.getElementById('templateSelector'),
            components: document.getElementById('componentsPanel'),
            color: document.getElementById('colorPanel'),
            device: document.getElementById('devicePanel'),
            challenge: document.getElementById('challengePanel'),
            rewards: document.getElementById('rewardsPanel'),
            newFeatures: document.getElementById('newFeaturesPanel'),
            leaderboard: document.getElementById('leaderboardPanel')
        };

        const overlay = document.getElementById('overlay');

        // Initialize CodeMirror Editors
        let htmlEditor, cssEditor, jsEditor;

        function initializeEditors() {
            htmlEditor = CodeMirror.fromTextArea(document.getElementById('htmlCode'), {
                mode: 'xml',
                theme: 'monokai',
                lineNumbers: true,
                autoCloseTags: true,
                matchBrackets: true,
                autoCloseBrackets: true
            });

            cssEditor = CodeMirror.fromTextArea(document.getElementById('cssCode'), {
                mode: 'css',
                theme: 'monokai',
                lineNumbers: true,
                matchBrackets: true,
                autoCloseBrackets: true
            });

            jsEditor = CodeMirror.fromTextArea(document.getElementById('jsCode'), {
                mode: 'javascript',
                theme: 'monokai',
                lineNumbers: true,
                matchBrackets: true,
                autoCloseBrackets: true
            });

            htmlEditor.refresh();
        }

        // Mobile Modal Management
        function showModal(modal) {
            if (window.innerWidth <= 768) {
                modal.style.display = 'block';
                overlay.style.display = 'block';
            } else {
                modal.style.display = 'block';
            }
        }

        function hideAllPanels() {
            Object.values(panels).forEach(panel => {
                if (panel) panel.style.display = 'none';
            });
            overlay.style.display = 'none';
        }

        overlay.addEventListener('click', hideAllPanels);

        // Feature Toggles
        document.getElementById('templatesBtn').addEventListener('click', () => showModal(panels.template));
        document.getElementById('componentsBtn').addEventListener('click', () => showModal(panels.components));
        document.getElementById('colorBtn').addEventListener('click', () => showModal(panels.color));
        document.getElementById('deviceBtn').addEventListener('click', () => showModal(panels.device));
        document.getElementById('challengeBtn').addEventListener('click', () => showModal(panels.challenge));
        document.getElementById('rewardsBtn').addEventListener('click', () => showModal(panels.rewards));
        document.getElementById('newFeaturesBtn').addEventListener('click', () => showModal(panels.newFeatures));

        // ================== COMPONENT LIBRARY ==================
        const componentLibrary = {
            components: {
                navbar: {
                    html: `<nav class="navbar">
    <div class="nav-brand">Your Logo</div>
    <ul class="nav-menu">
        <li><a href="#home">Home</a></li>
        <li><a href="#about">About</a></li>
        <li><a href="#services">Services</a></li>
        <li><a href="#contact">Contact</a></li>
    </ul>
</nav>`,
                    css: `.navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 2rem;
    background: #2c3e50;
    color: white;
}

.nav-brand {
    font-size: 1.5rem;
    font-weight: bold;
}

.nav-menu {
    display: flex;
    list-style: none;
    gap: 2rem;
}

.nav-menu a {
    color: white;
    text-decoration: none;
    transition: color 0.3s;
}

.nav-menu a:hover {
    color: #3498db;
}`
                },
                'contact-form': {
                    html: `<form class="contact-form">
    <h2>Contact Us</h2>
    <div class="form-group">
        <input type="text" placeholder="Your Name" required>
    </div>
    <div class="form-group">
        <input type="email" placeholder="Your Email" required>
    </div>
    <div class="form-group">
        <textarea placeholder="Your Message" rows="5" required></textarea>
    </div>
    <button type="submit">Send Message</button>
</form>`,
                    css: `.contact-form {
    max-width: 500px;
    margin: 0 auto;
    padding: 2rem;
}

.form-group {
    margin-bottom: 1rem;
}

.form-group input,
.form-group textarea {
    width: 100%;
    padding: 0.8rem;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 1rem;
}

button[type="submit"] {
    background: #3498db;
    color: white;
    padding: 1rem 2rem;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1rem;
}

button[type="submit"]:hover {
    background: #2980b9;
}`
                },
                cards: {
                    html: `<div class="card-grid">
    <div class="card">
        <h3>Feature One</h3>
        <p>Description of the first feature</p>
    </div>
    <div class="card">
        <h3>Feature Two</h3>
        <p>Description of the second feature</p>
    </div>
    <div class="card">
        <h3>Feature Three</h3>
        <p>Description of the third feature</p>
    </div>
</div>`,
                    css: `.card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
    padding: 2rem;
}

.card {
    background: white;
    padding: 2rem;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    transition: transform 0.3s;
}

.card:hover {
    transform: translateY(-5px);
}

.card h3 {
    color: #2c3e50;
    margin-bottom: 1rem;
}

.card p {
    color: #7f8c8d;
    line-height: 1.6;
}`
                }
            },

            init() {
                document.querySelectorAll('.component-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        const component = e.target.getAttribute('data-component');
                        this.insertComponent(component);
                    });
                });
            },

            insertComponent(componentName) {
                const component = this.components[componentName];
                if (component) {
                    htmlEditor.setValue(component.html);
                    cssEditor.setValue(component.css);
                    hideAllPanels();
                    launchCode();
                    Swal.fire('Success', `${componentName} component added!`, 'success');
                }
            }
        };

        // ================== COLOR GENERATOR ==================
        const colorGenerator = {
            init() {
                this.generateColorPalette();
                document.getElementById('baseColor').addEventListener('input', () => {
                    this.generateColorPalette();
                });
            },

            generateColorPalette() {
                const baseColor = document.getElementById('baseColor').value;
                const paletteContainer = document.getElementById('colorPalette');
                paletteContainer.innerHTML = '';

                // Generate color variations
                const variations = this.generateColorVariations(baseColor);
                
                variations.forEach(color => {
                    const colorOption = document.createElement('div');
                    colorOption.className = 'color-option';
                    colorOption.style.backgroundColor = color;
                    colorOption.title = color;
                    colorOption.addEventListener('click', () => {
                        this.applyColor(color);
                    });
                    paletteContainer.appendChild(colorOption);
                });
            },

            generateColorVariations(baseColor) {
                // Convert hex to RGB
                const hex = baseColor.replace('#', '');
                const r = parseInt(hex.substr(0, 2), 16);
                const g = parseInt(hex.substr(2, 2), 16);
                const b = parseInt(hex.substr(4, 2), 16);

                const variations = [];
                
                // Generate variations (lighter and darker)
                for (let i = -4; i <= 4; i++) {
                    if (i === 0) continue;
                    const factor = 1 + (i * 0.1);
                    const newR = Math.min(255, Math.max(0, Math.round(r * factor)));
                    const newG = Math.min(255, Math.max(0, Math.round(g * factor)));
                    const newB = Math.min(255, Math.max(0, Math.round(b * factor)));
                    
                    variations.push(this.rgbToHex(newR, newG, newB));
                }

                return [baseColor, ...variations];
            },

            rgbToHex(r, g, b) {
                return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
            },

            applyColor(color) {
                const css = `:root {
    --primary-color: ${color};
    --secondary-color: ${this.generateComplementary(color)};
}

body {
    color: ${color};
}`;

                cssEditor.setValue(css + '\n\n' + cssEditor.getValue());
                hideAllPanels();
                launchCode();
                Swal.fire('Color Applied!', `Primary color set to ${color}`, 'success');
            },

            generateComplementary(hex) {
                // Simple complementary color generation
                const hexNum = parseInt(hex.replace('#', ''), 16);
                const compHex = (0xFFFFFF ^ hexNum).toString(16).padStart(6, '0');
                return '#' + compHex;
            }
        };

        // ================== DEVICE EMULATOR ==================
        const deviceEmulator = {
            init() {
                document.querySelectorAll('.device-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const width = e.target.getAttribute('data-width');
                        const height = e.target.getAttribute('data-height');
                        this.setDeviceSize(width, height);
                    });
                });
            },

            setDeviceSize(width, height) {
                const liveFrame = document.getElementById('liveFrame');
                liveFrame.style.width = width + 'px';
                liveFrame.style.height = height + 'px';
                liveFrame.style.maxWidth = '100%';
                liveFrame.style.margin = '0 auto';
                liveFrame.style.display = 'block';
                
                hideAllPanels();
                Swal.fire('Device Mode', `Set to ${width}x${height}`, 'info');
            }
        };

        // ================== CHALLENGE SYSTEM ==================
        const challengeSystem = {
            challenges: {
                counter: {
                    title: "Build a Counter",
                    description: "Create a counter that increments and decrements",
                    html: `<div class="counter">
    <h1>Counter: <span id="count">0</span></h1>
    <button onclick="increment()">+</button>
    <button onclick="decrement()">-</button>
    <button onclick="reset()">Reset</button>
</div>`,
                    css: `.counter {
    text-align: center;
    padding: 2rem;
}

.counter button {
    margin: 0 10px;
    padding: 10px 20px;
    font-size: 1.2rem;
    cursor: pointer;
}`,
                    js: `let count = 0;

function increment() {
    count++;
    document.getElementById('count').textContent = count;
}

function decrement() {
    count--;
    document.getElementById('count').textContent = count;
}

function reset() {
    count = 0;
    document.getElementById('count').textContent = count;
}`
                },
                timer: {
                    title: "Create a Timer",
                    description: "Build a countdown timer with start/stop functionality",
                    html: `<div class="timer">
    <h1>Timer: <span id="time">60</span>s</h1>
    <button onclick="startTimer()">Start</button>
    <button onclick="stopTimer()">Stop</button>
    <button onclick="resetTimer()">Reset</button>
</div>`,
                    css: `.timer {
    text-align: center;
    padding: 2rem;
}

.timer button {
    margin: 0 10px;
    padding: 10px 20px;
    font-size: 1.2rem;
    cursor: pointer;
}`,
                    js: `let time = 60;
let timerInterval;

function startTimer() {
    timerInterval = setInterval(() => {
        time--;
        document.getElementById('time').textContent = time;
        if (time <= 0) {
            clearInterval(timerInterval);
            alert("Time's up!");
        }
    }, 1000);
}

function stopTimer() {
    clearInterval(timerInterval);
}

function resetTimer() {
    clearInterval(timerInterval);
    time = 60;
    document.getElementById('time').textContent = time;
}`
                }
            },

            init() {
                document.querySelectorAll('.challenge-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        const challenge = e.target.getAttribute('data-challenge');
                        this.startChallenge(challenge);
                    });
                });
            },

            startChallenge(challengeName) {
                const challenge = this.challenges[challengeName];
                if (challenge) {
                    Swal.fire({
                        title: challenge.title,
                        text: challenge.description,
                        icon: 'info',
                        showCancelButton: true,
                        confirmButtonText: 'Start Challenge',
                        cancelButtonText: 'Cancel'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            htmlEditor.setValue(challenge.html);
                            cssEditor.setValue(challenge.css);
                            jsEditor.setValue(challenge.js);
                            hideAllPanels();
                            launchCode();
                        }
                    });
                }
            }
        };

        // ================== REWARD SYSTEM ==================
        const rewardSystem = {
            achievements: JSON.parse(localStorage.getItem('neuralLabAchievements') || '{}'),
            
            unlockAchievement(name) {
                this.achievements[name] = true;
                localStorage.setItem('neuralLabAchievements', JSON.stringify(this.achievements));
                
                Swal.fire({
                    title: 'Achievement Unlocked! üèÜ',
                    text: `You've earned: ${name}`,
                    icon: 'success',
                    timer: 3000
                });
            },
            
            checkAchievements() {
                // Check for various achievements
                const code = htmlEditor.getValue() + cssEditor.getValue() + jsEditor.getValue();
                
                if (code.length > 1000 && !this.achievements.codeMaster) {
                    this.unlockAchievement('Code Master');
                }
                
                if (code.includes('var(') && !this.achievements.designPro) {
                    this.unlockAchievement('Design Pro');
                }
            }
        };

        // ================== 40+ FEATURES SYSTEM ==================
        const advancedFeatures = {
            init() {
                document.querySelectorAll('.feature-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        const feature = e.target.getAttribute('data-feature');
                        this.activateFeature(feature);
                    });
                });
            },

            activateFeature(featureName) {
                switch(featureName) {
                    case 'darkMode':
                        this.toggleDarkMode();
                        break;
                    case 'splitView':
                        this.enableSplitView();
                        break;
                    case 'leaderboard':
                        showModal(panels.leaderboard);
                        break;
                    case 'voiceComments':
                        this.enableVoiceComments();
                        break;
                    case 'soundEffects':
                        this.enableSoundEffects();
                        break;
                    default:
                        Swal.fire('Feature Coming Soon', `${featureName} will be available in the next update!`, 'info');
                }
            },

            toggleDarkMode() {
                const body = document.body;
                const isDark = body.style.backgroundColor === 'rgb(0, 0, 0)';
                
                if (isDark) {
                    body.style.backgroundColor = '#f0f0f0';
                    body.style.color = '#000';
                    document.getElementById('modeIcon').textContent = '‚òÄÔ∏è';
                } else {
                    body.style.backgroundColor = '#000';
                    body.style.color = '#fff';
                    document.getElementById('modeIcon').textContent = 'üåô';
                }
                
                Swal.fire('Theme Changed', `Switched to ${isDark ? 'Light' : 'Dark'} mode`, 'success');
            },

            enableSplitView() {
                const editorPanel = document.querySelector('.editor-panel');
                const previewPanel = document.querySelector('.preview-panel');
                
                if (editorPanel.classList.contains('split-view-container')) {
                    editorPanel.classList.remove('split-view-container');
                    previewPanel.style.display = 'block';
                } else {
                    editorPanel.classList.add('split-view-container');
                    previewPanel.style.display = 'none';
                    
                    // Create split view
                    const splitHTML = `
                        <div class="split-editor">
                            <div class="synapse-tabs">
                                <button class="syn-tab active" data-lang="html">HTML</button>
                                <button class="syn-tab" data-lang="css">CSS</button>
                                <button class="syn-tab" data-lang="js">JS</button>
                            </div>
                            <div class="code-area">
                                <textarea id="htmlCode" class="neural-editor hidden"></textarea>
                                <textarea id="cssCode" class="neural-editor hidden"></textarea>
                                <textarea id="jsCode" class="neural-editor hidden"></textarea>
                            </div>
                        </div>
                        <div class="split-preview">
                            <canvas id="neuralCanvas"></canvas>
                            <iframe id="liveFrame" title="live preview"></iframe>
                        </div>
                    `;
                    
                    editorPanel.innerHTML = splitHTML + editorPanel.querySelector('.neural-controls').outerHTML;
                    
                    // Reinitialize editors
                    setTimeout(() => {
                        initializeEditors();
                        loadFromMemory();
                        launchCode();
                    }, 100);
                }
                
                hideAllPanels();
            },

            enableVoiceComments() {
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance('Voice comments activated. You can now add voice notes to your code.');
                    speechSynthesis.speak(utterance);
                    Swal.fire('Voice Comments', 'Voice comments feature activated!', 'success');
                } else {
                    Swal.fire('Not Supported', 'Your browser does not support speech synthesis', 'error');
                }
            },

            enableSoundEffects() {
                // Create audio context for sound effects
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Play a success sound
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.01);
                gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
                
                Swal.fire('Sound Effects', 'Interactive sound effects activated!', 'success');
            }
        };

        // ================== AUDIO CONTROLS ==================
        const audioSystem = {
            init() {
                document.getElementById('playAudio').addEventListener('click', () => {
                    this.playBackgroundMusic();
                });
                
                document.getElementById('stopAudio').addEventListener('click', () => {
                    this.stopBackgroundMusic();
                });
            },
            
            playBackgroundMusic() {
                // Create ambient background sound
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 110;
                oscillator.type = 'sine';
                gainNode.gain.value = 0.02;
                
                oscillator.start();
                
                // Store reference to stop later
                this.backgroundSound = { oscillator, gainNode, audioContext };
                
                Swal.fire('Ambient Sound', 'Background music activated', 'info');
            },
            
            stopBackgroundMusic() {
                if (this.backgroundSound) {
                    this.backgroundSound.oscillator.stop();
                    Swal.fire('Sound Stopped', 'Background music turned off', 'info');
                }
            }
        };

        // ================== CORE FUNCTIONALITY ==================
        function launchCode() {
            const html = htmlEditor.getValue() || '';
            const css = cssEditor.getValue() || '';
            const js = jsEditor.getValue() || '';

            const blob = new Blob([`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="utf-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <style>${css}</style>
                </head>
                <body>${html}
                    <script>${js}<\/script>
                </body>
                </html>
            `], {type: 'text/html'});

            const liveFrame = document.getElementById('liveFrame');
            liveFrame.src = URL.createObjectURL(blob);
            liveFrame.style.opacity = 0;
            setTimeout(() => liveFrame.style.opacity = 1, 200);
            
            // Check for achievements
            rewardSystem.checkAchievements();
        }

        // Tab switching
        document.querySelectorAll('.syn-tab').forEach(t => {
            t.addEventListener('click', () => {
                document.querySelectorAll('.syn-tab').forEach(x => x.classList.remove('active'));
                t.classList.add('active');
                
                if (t.dataset.lang === 'html') htmlEditor.refresh();
                if (t.dataset.lang === 'css') cssEditor.refresh();
                if (t.dataset.lang === 'js') jsEditor.refresh();
            });
        });

        // Template system
        const templates = {
            starter: {
                html: '<!-- Start coding here -->\n<div class="container">\n    <h1>Hello World!</h1>\n    <p>Start building your amazing project.</p>\n</div>',
                css: '/* Add your styles here */\nbody {\n    font-family: Arial, sans-serif;\n    margin: 0;\n    padding: 20px;\n    background: #f0f0f0;\n}\n\n.container {\n    max-width: 800px;\n    margin: 0 auto;\n    background: white;\n    padding: 20px;\n    border-radius: 8px;\n    box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n}',
                js: '// Add your JavaScript here\nconsole.log("Hello from Neural Code Lab!");'
            }
        };

        document.querySelectorAll('.template-item').forEach(item => {
            item.addEventListener('click', function() {
                const template = this.getAttribute('data-template');
                if (templates[template]) {
                    htmlEditor.setValue(templates[template].html);
                    cssEditor.setValue(templates[template].css);
                    jsEditor.setValue(templates[template].js);
                    hideAllPanels();
                    launchCode();
                }
            });
        });

        // Core functionality
        function saveToMemory(){
            const payload = {
                html: htmlEditor.getValue(),
                css: cssEditor.getValue(),
                js: jsEditor.getValue()
            };
            localStorage.setItem('neuralLab', JSON.stringify(payload));
            Swal.fire({icon:'success', title:'Saved', text:'Code stored in neural memory', timer:1300});
        }

        function loadFromMemory(){
            const data = localStorage.getItem('neuralLab');
            if(!data) return;
            const p = JSON.parse(data);
            htmlEditor.setValue(p.html || '');
            cssEditor.setValue(p.css || '');
            jsEditor.setValue(p.js || '');
        }

        document.getElementById('saveBtn').addEventListener('click', saveToMemory);
        document.getElementById('runBtn').addEventListener('click', launchCode);

        document.getElementById('clearBtn').addEventListener('click', () => {
            htmlEditor.setValue('');
            cssEditor.setValue('');
            jsEditor.setValue('');
            launchCode();
        });

        document.getElementById('zipBtn').addEventListener('click', () => {
            const zip = new JSZip();
            zip.file('index.html', htmlEditor.getValue() || '');
            zip.file('style.css', cssEditor.getValue() || '');
            zip.file('script.js', jsEditor.getValue() || '');
            zip.generateAsync({type:'blob'}).then(b => {
                const a = document.createElement('a');
                a.href = URL.createObjectURL(b);
                a.download = 'neural-lab.zip';
                a.click();
            });
        });

        // Additional features
        document.getElementById('analyzeBtn').addEventListener('click', () => {
            const htmlLines = htmlEditor.getValue().split('\n').length;
            const cssLines = cssEditor.getValue().split('\n').length;
            const jsLines = jsEditor.getValue().split('\n').length;
            const totalLines = htmlLines + cssLines + jsLines;
            
            Swal.fire({
                title: 'Code Analysis',
                html: `
                    <div style="text-align: left;">
                        <p><strong>HTML:</strong> ${htmlLines} lines</p>
                        <p><strong>CSS:</strong> ${cssLines} lines</p>
                        <p><strong>JavaScript:</strong> ${jsLines} lines</p>
                        <p><strong>Total:</strong> ${totalLines} lines</p>
                    </div>
                `,
                icon: 'info'
            });
        });

        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeEditors();
            loadFromMemory();
            launchCode();
            
            // Initialize all systems
            componentLibrary.init();
            colorGenerator.init();
            deviceEmulator.init();
            challengeSystem.init();
            advancedFeatures.init();
            audioSystem.init();
            
            // Unlock first achievement
            if (!rewardSystem.achievements.firstProject) {
                rewardSystem.unlockAchievement('First Project');
            }
        });
    </script>
</body>
</html>
